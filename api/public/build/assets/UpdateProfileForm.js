import{_ as R,x as j,k as v,l as E,i as x,c as U,o as a,w as V,a as s,e as H,f as i,h as p,b as _,j as y,u as n,F as w,p as C,t as c,q as P,s as G,W as $}from"./app2.js";import{B as q,l as d}from"./BaseLayout.js";const z={class:"min-h-screen flex items-center justify-center bg-[#18191A]"},L={class:"flex-1 flex flex-col justify-center"},W={class:"mb-4"},K={class:"flex"},Y=["value"],J=["placeholder"],Q={key:0,class:"text-red-400 text-xs mt-1"},X={key:1,class:"text-yellow-400 text-xs mt-1"},Z={class:"mb-4"},ee=["value"],te={key:0,class:"text-red-400 text-xs mt-1"},oe={class:"mb-5"},se={class:"relative"},re={for:"resume-upload",class:"group flex items-center w-full h-[42px] px-3 rounded-xl bg-[#18191A] text-white border border-[#353535] focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/30 transition outline-none cursor-pointer pr-20"},le={class:"ml-4 text-sm text-gray-200 truncate"},ne={key:0,class:"text-red-400 text-xs mt-1"},ue=["disabled"],ae={__name:"UpdateProfileForm",props:{user:Object},setup(k){const u=k,F=["Faculty of Engineering","Faculty of Engineering & Technology","Faculty of Artificial Intelligence & Engineering","Faculty of Business","Faculty of Management","Faculty of Computing & Infomatics","Faculty of Information Science & Technology","Faculty of Creative Multimedia","Faculty of Cinematic Arts","Faculty of Applied Communication","Faculty of Law"],f=[{code:"MY",dial:"+60",placeholder:"19 123 4567"},{code:"SG",dial:"+65",placeholder:"1234 5678"},{code:"ID",dial:"+62",placeholder:"21 1234 5678"},{code:"PH",dial:"+63",placeholder:"912 345 6789"},{code:"CH",dial:"+86",placeholder:"135 1234 5678"}],b={"+65":{min:8,max:8},"+60":{min:9,max:10},"+62":{min:10,max:12},"+63":{min:10,max:10},"+86":{min:11,max:11}},t=j({_method:"patch",countryCode:"",phone:"",faculty:u.user.faculty,resume:null,resumeName:u.user.resume?u.user.resume.split("/").pop():"",remove_resume:!1}),l=v({}),h=v(null);E(()=>{const o=u.user.phone||"",e=[...f].sort((m,M)=>M.dial.length-m.dial.length);let r=!1;for(const m of e)if(o.startsWith(m.dial)){t.countryCode=m.dial,t.phone=o.substring(m.dial.length),r=!0;break}r||(t.countryCode=f[0].dial,t.phone=o.replace(/\D/g,""))});const I=x(()=>{const o=f.find(e=>e.dial===t.countryCode);return o?o.placeholder:""}),g=x(()=>{if(!t.phone)return"";const o=b[t.countryCode],e=t.phone.replace(/\D/g,"").length;return e<o.min?`Phone number must be at least ${o.min} digits for this country`:e>o.max?`Phone number must be at most ${o.max} digits for this country`:""}),N=x(()=>{if(!t.phone||!t.faculty)return!1;const o=b[t.countryCode],e=t.phone.replace(/\D/g,"").length;return e>=o.min&&e<=o.max});function O(){if(l.value={},!t.phone)l.value.phone="Phone number is required";else{const o=b[t.countryCode],e=t.phone.replace(/\D/g,"").length;(e<o.min||e>o.max)&&(l.value.phone=`Phone number must be ${o.min}${o.min!==o.max?"-"+o.max:""} digits for this country`)}return t.faculty||(l.value.faculty="Faculty is required"),t.resume&&t.resume.size>2*1024*1024&&(l.value.resume="Resume must be 2MB or less"),Object.keys(l.value).length===0}function T(o){const e=o.target.files[0];if(e){if(e.type!=="application/pdf"){t.resume=null,t.resumeName=u.user.resume?u.user.resume.split("/").pop():"",l.value.resume="Only PDF files are allowed",o.target.value="";return}if(e.size>2*1024*1024){t.resume=null,t.resumeName=u.user.resume?u.user.resume.split("/").pop():"",l.value.resume="Resume must be 2MB or less",o.target.value="";return}t.resume=e,t.resumeName=e.name,t.remove_resume=!1,l.value.resume=""}}function S(){t.resume=null,t.resumeName="",t.remove_resume=!0,h.value&&(h.value.value="")}function A(o){let e=o.target.value.replace(/\D/g,"");const r=b[t.countryCode];e.length>r.max&&(e=e.slice(0,r.max)),t.phone=e}function B(o){/[0-9]/.test(o.key)||o.preventDefault()}function D(){if(!O()){Object.values(l.value).forEach(o=>{d.error(o,{position:d.POSITION.TOP_RIGHT,autoClose:3e3})});return}t.transform(o=>({...o,phone:o.countryCode+o.phone})).post(route("profile.update"),{onSuccess:()=>{d.success("Profile updated successfully!",{position:d.POSITION.TOP_RIGHT,autoClose:3e3}),$.get(route("profile.show"))},onError:o=>{Object.values(o).forEach(e=>{d.error(e,{position:d.POSITION.TOP_RIGHT,autoClose:3e3})})}})}return(o,e)=>(a(),U(q,null,{default:V(()=>[s("div",z,[s("form",{onSubmit:H(D,["prevent"]),class:"bg-[#232323] p-6 rounded-2xl shadow-xl w-full max-w-md border border-[#292929] flex flex-col justify-between h-auto min-h-[400px]"},[e[8]||(e[8]=s("div",null,[s("h2",{class:"text-base font-bold mb-4 text-center text-white"},"Update Your Profile")],-1)),s("div",L,[s("div",W,[e[3]||(e[3]=s("label",{class:"block text-gray-300 mb-1 text-sm"},[s("span",{class:"text-red-500"},"*"),_(" Phone Number")],-1)),s("div",K,[y(s("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>n(t).countryCode=r),class:"rounded-l-xl px-3 py-2 bg-[#18191A] text-white border border-[#353535] focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition outline-none custom-no-arrow text-sm"},[(a(),i(w,null,C(f,r=>s("option",{key:r.code,value:r.dial}," ("+c(r.dial)+") ",9,Y)),64))],512),[[P,n(t).countryCode]]),y(s("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>n(t).phone=r),placeholder:I.value,type:"text",class:"w-full px-3 py-2 rounded-r-xl bg-[#18191A] text-white border-t border-b border-r border-[#353535] focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition outline-none text-sm",onInput:A,onKeypress:B},null,40,J),[[G,n(t).phone]])]),l.value.phone?(a(),i("div",Q,c(l.value.phone),1)):p("",!0),g.value?(a(),i("div",X,c(g.value),1)):p("",!0)]),s("div",Z,[e[5]||(e[5]=s("label",{class:"block text-gray-300 mb-1 text-sm"},[s("span",{class:"text-red-500"},"*"),_(" Faculty")],-1)),y(s("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>n(t).faculty=r),class:"w-full px-3 py-2 rounded-xl bg-[#18191A] text-white border border-[#353535] focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition outline-none text-sm"},[e[4]||(e[4]=s("option",{value:"",disabled:""},"Select faculty",-1)),(a(),i(w,null,C(F,r=>s("option",{key:r,value:r},c(r),9,ee)),64))],512),[[P,n(t).faculty]]),l.value.faculty?(a(),i("div",te,c(l.value.faculty),1)):p("",!0)]),s("div",oe,[e[7]||(e[7]=s("label",{for:"resume-upload",class:"block text-gray-300 mb-1 text-sm"},"Resume",-1)),s("div",se,[s("input",{id:"resume-upload",type:"file",accept:".pdf",onChange:T,ref_key:"fileInput",ref:h,class:"hidden"},null,544),s("label",re,[e[6]||(e[6]=s("span",{class:"inline-block py-1 px-3 rounded-lg border-0 text-sm font-semibold text-nowrap text-gray-200 transition-colors bg-[#3A3B3C] group-hover:bg-indigo-900 group-hover:text-white"},"Choose file",-1)),s("span",le,c(n(t).resumeName||"No file chosen"),1)]),n(t).resumeName?(a(),i("button",{key:0,type:"button",onClick:S,class:"absolute top-1/2 right-3 -translate-y-1/2 text-red-500 hover:text-red-700 text-xs font-semibold",style:{"z-index":"2"}}," Remove ")):p("",!0)]),l.value.resume?(a(),i("div",ne,c(l.value.resume),1)):p("",!0)])]),s("div",null,[s("button",{type:"submit",disabled:!N.value||n(t).processing,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-xl shadow transition disabled:opacity-50 text-base"}," Update ",8,ue)])],32)])]),_:1}))}},de=R(ae,[["__scopeId","data-v-3aa0a116"]]);export{de as default};
