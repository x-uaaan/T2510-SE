import{_ as B,x as L,k as g,i as b,l as z,c as V,o as u,w as E,a as o,e as H,j as m,u as n,m as w,n as _,f as a,h as d,b as h,F as T,p as C,t as c,q as P,s as G,W as k}from"./app-DHppAmMz.js";import{B as U,l as i}from"./BaseLayout-BQY79M6j.js";const $={class:"min-h-screen flex items-center justify-center bg-[#18191A]"},q={class:"flex-1 flex flex-col justify-center"},K={class:"mb-4 flex items-center justify-center gap-8"},W={class:"flex items-center cursor-pointer"},Y={key:0,class:"w-3 h-3 bg-blue-500 rounded-full block"},J={class:"flex items-center cursor-pointer"},Q={key:0,class:"w-3 h-3 bg-blue-500 rounded-full block"},X={class:"mb-4"},Z={class:"flex"},ee=["value"],te=["placeholder"],se={key:0,class:"text-red-400 text-xs mt-1"},oe={key:1,class:"text-yellow-400 text-xs mt-1"},le={class:"mb-4"},re=["value"],ne={key:0,class:"text-red-400 text-xs mt-1"},ue={class:"mb-5"},ae={class:"relative"},ie={key:0,class:"text-red-400 text-xs mt-1"},de=["disabled"],ce={__name:"CompleteProfile",props:["email","name"],setup(I){const p=I,F=["Faculty of Engineering","Faculty of Engineering & Technology","Faculty of Artificial Intelligence & Engineering","Faculty of Business","Faculty of Management","Faculty of Computing & Infomatics","Faculty of Information Science & Technology","Faculty of Creative Multimedia","Faculty of Cinematic Arts","Faculty of Applied Communication","Faculty of Law"],y=[{code:"MY",dial:"+60",placeholder:"19 123 4567"},{code:"SG",dial:"+65",placeholder:"1234 5678"},{code:"ID",dial:"+62",placeholder:"21 1234 5678"},{code:"PH",dial:"+63",placeholder:"912 345 6789"},{code:"CH",dial:"+86",placeholder:"135 1234 5678"}],f={"+65":{min:8,max:8},"+60":{min:9,max:10},"+62":{min:10,max:12},"+63":{min:10,max:10},"+86":{min:11,max:11}},t=L({countryCode:y[0].dial,phone:"",faculty:"",resume:null,resumeName:"",userType:"",email:"",name:""}),r=g({}),A=b(()=>{const s=y.find(e=>e.dial===t.countryCode);return s?s.placeholder:""});b(()=>t.resume?`${(t.resume.size/(1024*1024)).toFixed(1)}MB`:"");function O(){if(r.value={},!t.phone)r.value.phone="Phone number is required";else{const s=f[t.countryCode],e=t.phone.replace(/\D/g,"").length;(e<s.min||e>s.max)&&(r.value.phone=`Phone number must be ${s.min}${s.min!==s.max?"-"+s.max:""} digits for this country`)}return t.faculty||(r.value.faculty="Faculty is required"),t.userType||(r.value.userType="Please select a role"),t.resume&&t.resume.size>2*1024*1024&&(r.value.resume="Resume must be 2MB or less"),Object.keys(r.value).length===0}const N=b(()=>{if(!t.userType||!t.phone||!t.faculty)return!1;const s=f[t.countryCode],e=t.phone.replace(/\D/g,"").length;return!(e<s.min||e>s.max)}),v=b(()=>{if(!t.phone)return"";const s=f[t.countryCode],e=t.phone.replace(/\D/g,"").length;return e<s.min?`Phone number must be at least ${s.min} digits for this country`:e>s.max?`Phone number must be at most ${s.max} digits for this country`:""});function S(s){const e=s.target.files[0];if(e){if(e.type!=="application/pdf"){t.resume=null,t.resumeName="",r.value.resume="Only PDF files are allowed",s.target.value="";return}if(e.size>2*1024*1024){t.resume=null,t.resumeName="",r.value.resume="File size must be 2MB or less",s.target.value="";return}t.resume=e,t.resumeName=e.name,r.value.resume=""}}const x=g(null);function D(){t.resume=null,t.resumeName="",x.value&&(x.value.value="")}function M(s){let e=s.target.value.replace(/\D/g,"");const l=f[t.countryCode];e.length>l.max&&(e=e.slice(0,l.max)),t.phone=e}function R(s){/[0-9]/.test(s.key)||s.preventDefault()}z(()=>{p.email&&(t.email=p.email),p.name&&(t.name=p.name)});async function j(){if(!O()){Object.keys(r.value).forEach(e=>{i.error(r.value[e],{position:i.POSITION.TOP_RIGHT,autoClose:3e3})});return}const s=new FormData;s.append("email",t.email),s.append("name",t.name),s.append("phone",t.countryCode+t.phone),s.append("faculty",t.faculty),s.append("userType",t.userType),t.resume&&s.append("resume",t.resume);try{await k.post("/complete-profile",s,{onSuccess:()=>{i.success("Profile completed successfully!",{position:i.POSITION.TOP_RIGHT,autoClose:3e3}),k.visit("/events")},onError:e=>{Object.keys(e).forEach(l=>{i.error(e[l],{position:i.POSITION.TOP_RIGHT,autoClose:3e3})})}})}catch{i.error("An error occurred while saving your profile",{position:i.POSITION.TOP_RIGHT,autoClose:3e3})}}return(s,e)=>(u(),V(U,null,{default:E(()=>[o("div",$,[o("form",{onSubmit:H(j,["prevent"]),class:"bg-[#232323] p-6 rounded-2xl shadow-xl w-full max-w-md border border-[#292929] flex flex-col justify-between h-[500px]"},[e[12]||(e[12]=o("div",null,[o("img",{src:"/image/CampusPulse.png",alt:"Campus Pulse Logo",class:"mx-auto mb-2 h-12"}),o("h2",{class:"text-base font-bold mb-4 text-center text-white"},"Complete Your Profile")],-1)),o("div",q,[o("div",K,[o("label",W,[m(o("input",{type:"radio","onUpdate:modelValue":e[0]||(e[0]=l=>n(t).userType=l),value:"Alumni",class:"hidden"},null,512),[[w,n(t).userType]]),o("span",{class:_(["w-5 h-5 rounded-full border-2 flex items-center justify-center mr-2",n(t).userType==="Alumni"?"border-blue-500":"border-gray-500"])},[n(t).userType==="Alumni"?(u(),a("span",Y)):d("",!0)],2),e[5]||(e[5]=o("span",{class:"text-white text-base"},"Alumni",-1))]),o("label",J,[m(o("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=l=>n(t).userType=l),value:"Lecturer",class:"hidden"},null,512),[[w,n(t).userType]]),o("span",{class:_(["w-5 h-5 rounded-full border-2 flex items-center justify-center mr-2",n(t).userType==="Lecturer"?"border-blue-500":"border-gray-500"])},[n(t).userType==="Lecturer"?(u(),a("span",Q)):d("",!0)],2),e[6]||(e[6]=o("span",{class:"text-white text-base"},"Lecturer",-1))])]),o("div",X,[e[7]||(e[7]=o("label",{class:"block text-gray-300 mb-1 text-sm"},[o("span",{class:"text-red-500"},"*"),h(" Phone Number")],-1)),o("div",Z,[m(o("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>n(t).countryCode=l),class:"rounded-l-xl px-3 py-2 bg-[#18191A] text-white border border-[#353535] focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition outline-none custom-no-arrow text-sm"},[(u(),a(T,null,C(y,l=>o("option",{key:l.code,value:l.dial}," ("+c(l.dial)+") ",9,ee)),64))],512),[[P,n(t).countryCode]]),m(o("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>n(t).phone=l),placeholder:A.value,type:"text",class:"w-full px-3 py-2 rounded-r-xl bg-[#18191A] text-white border-t border-b border-r border-[#353535] focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition outline-none text-sm",onInput:M,onKeypress:R},null,40,te),[[G,n(t).phone]])]),r.value.phone?(u(),a("div",se,c(r.value.phone),1)):d("",!0),v.value?(u(),a("div",oe,c(v.value),1)):d("",!0)]),o("div",le,[e[9]||(e[9]=o("label",{class:"block text-gray-300 mb-1 text-sm"},[o("span",{class:"text-red-500"},"*"),h(" Faculty")],-1)),m(o("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>n(t).faculty=l),class:"w-full px-3 py-2 rounded-xl bg-[#18191A] text-white border border-[#353535] focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition outline-none text-sm"},[e[8]||(e[8]=o("option",{value:"",disabled:""},"Select faculty",-1)),(u(),a(T,null,C(F,l=>o("option",{key:l,value:l},c(l),9,re)),64))],512),[[P,n(t).faculty]]),r.value.faculty?(u(),a("div",ne,c(r.value.faculty),1)):d("",!0)]),o("div",ue,[e[10]||(e[10]=o("label",{for:"resume-upload",class:"block text-gray-300 mb-1 text-sm"},"Resume",-1)),o("div",ae,[o("input",{id:"resume-upload",type:"file",accept:".pdf",onChange:S,ref_key:"fileInput",ref:x,class:"block w-full text-sm text-gray-200 file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-[#18191A] file:text-white hover:file:bg-[#23233b] bg-[#18191A] border border-[#353535] rounded-xl pr-20"},null,544),n(t).resumeName?(u(),a("button",{key:0,type:"button",onClick:D,class:"absolute top-1/2 right-3 -translate-y-1/2 text-red-500 hover:text-red-700 text-xs font-semibold",style:{"z-index":"2"}}," Remove ")):d("",!0)]),r.value.resume?(u(),a("div",ie,c(r.value.resume),1)):d("",!0)])]),o("div",null,[o("button",{type:"submit",disabled:!N.value,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-xl shadow transition disabled:opacity-50 text-base"}," Register ",8,de),e[11]||(e[11]=o("div",{class:"text-center mt-2 text-sm text-gray-400"},[h(" Already have an account? "),o("a",{href:"/auth/microsoft",class:"text-blue-400 hover:underline ml-1"},"Log in!")],-1))])],32)])]),_:1}))}},fe=B(ce,[["__scopeId","data-v-3c46335b"]]);export{fe as default};
